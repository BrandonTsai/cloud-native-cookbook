<html>
<head>
  <style>
  table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
  }
  th, td {
    padding: 15px;
    text-align: left;
  }
  table#t01 {
    width: 100%;
    background-color: #f1f1c1;
  }
  h2 {
    margin-top: 35px;
  }
  h3, h4 {
    margin-top: 25px;
  }
  </style>
</head>
<body>
  
<p>Splunk collects the resource information by calling the Kubernetes API. It help user/operator to set up splunk alerts when pod is in Error status.</p>
<h2>Prerequisites</h2>
<p>Download the lastest Helm package from <a href="https://github.com/splunk/splunk-connect-for-kubernetes">Splunk-connect-for-kubernetes</a>.</p>
<h2>Update values.yaml for objects</h2>
<p>The minimal value example:</p>
<pre class="codehilite"><code class="language-YAML">splunk:
  hec:
    host: &lt; splunk_host &gt;
    port: 8088
    token: &lt; splunk_hec_objects_token &gt;
    indexName: &lt; splunk_objects_indexname &gt;</code></pre>


<h2>Deplopy to Kubernetes Cluster</h2>
<p>You can deploy to kubernetes cluster via helm directly.
Or generate kubernetes yaml files via helm template command and then deploy via kubectl.</p>
<pre class="codehilite"><code class="language-bash">helm template --name-template=k8s --namespace splunk-connect --output-dir ${output_folder} splunk-kubernetes-objects/

kubectl apply -f ${output_folder}/splunk-kubernetes-objects/templates/</code></pre>


<h2>Verify on Splunk</h2>
<p>Query the number of running pods in splunk-connect namespace</p>
<pre class="codehilite"><code>index=&quot;k8s_&lt;ENV&gt;_objects&quot; metadata.namespace=&quot;splunk-connect&quot; status.phase=&quot;Running&quot; | stats distinct_count(metadata.uid)</code></pre>
</body>
</html>